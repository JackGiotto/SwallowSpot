<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon/swallowspot_favicon_full.png') }}" type="image/x-icon">
    <title>SwallowSpot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/64fd56171c.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/index.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/animations.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/slider/slider.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/slider/slider_visual_mode.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/slider/slider_notification.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/home/home.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/info/info.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/reports/risk.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/account/profile.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/account/admin.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/search.css') }}>
    <link rel="stylesheet" href={{ url_for('static', filename = 'css/calendar.css') }}>
    <link rel="manifest" href={{ url_for('static', filename = 'manifest.json') }}>
</head>
<body>
    <!--navbar-->
    <header id="menu">
        <!--trigger menu-->
        <div id="menu2" class="nav-sides" title="Menu">
            <a data-bs-toggle="offcanvas" href="#offcanvasMenu" role="button" aria-controls="offcanvasMenu">
                <i class="fa-solid fa-bars"></i>
            </a>
        </div>
        <!--links-->
        <div id="links">
            <a href="{{ url_for('home.home') }}"><i class="fa-solid fa-house"></i> Home</a>
            <a href="{{ url_for('reports.hydro') }}" class="shrink1"><i class="fa-solid fa-triangle-exclamation"></i> Ultimi Bollettini</a>
            <a href="{{ url_for('info.info') }}" class="shrink2"><i class="fa-solid fa-bookmark"></i> Info e legende sui rischi</a>
        </div>
        <!--login-->
        <div id="login" class="nav-sides" title="Profilo e impostazioni">
            <a href="{{ url_for('profile.user') }}"><i class="fa-solid fa-user"></i></a>
        </div>
    </header>
    
    <!--offcanvas menu-->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
        <div class="offcanvas-header" data-bs-theme="dark">
            <h4 class="offcanvas-title" id="offcanvasMenuLabel">Menu</h4>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div id="otherLinks">
                <h5>Link principali</h5>
                <a href="{{ url_for('home.home') }}"><i class="fa-solid fa-house"></i>&ThickSpace; Home</a>
                <a href="{{ url_for('reports.hydro') }}"><i class="fa-solid fa-triangle-exclamation"></i>&ThickSpace; Ultimi bollettini</a>
                <a href="{{ url_for('info.info') }}"><i class="fa-solid fa-bookmark"></i>&ThickSpace; Info e legende sui rischi</a>
            </div>
            <div id="account">
                <h5>Account</h5>
                <a href="{{ url_for('profile.user') }}"><i class="fa-solid fa-user"></i>&ThickSpace; Profilo e impostazioni</a>
            </div>
            {% if 'username' not in session %}
                <div id="access">
                    <h5>Accesso</h5>
                    <a href="{{ url_for('auth.login') }}"><i class="fa-solid fa-right-to-bracket"></i>&ThickSpace; Accedi</a>
                    <a href="{{ url_for('auth.signup') }}"><i class="fa-solid fa-pen-nib"></i>&ThickSpace; Registrati</a>
                </div>
            {% endif %}
        </div>
    </div>
    
    <!--cookies label-->
    <div id="cookies">
        <h5><i class="fa-solid fa-cookie"></i> Cookies</h5>
        <p>here goes the description and the indications for the cookies!!!!!!!!!!!! mmmmmh yummmy</p>
        <div id="cookieButtons">
            <button type="button" class="btn btn-secondary" onclick="reject()"><i class="fa-solid fa-xmark"></i> Rifiuta tutti</button>
            <button type="button" class="btn btn-success"><i class="fa-solid fa-check"></i> Accetta tutti</button>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#customizeCookies"><i class="fa-solid fa-pencil"></i> Personalizza</button>
        </div>
    </div>
    
    <!-- Scrollable modal -->
    <div class="modal fade" id="customizeCookies" tabindex="-1" aria-labelledby="customizeCookiesLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="CustomizeCookiesLabel"><i class="fa-solid fa-cookie"></i> Personalizza i Cookies</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    here go the cookies informations<br>
                    <form action=""> <!--save the choices for cookies-->
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary">Salva le mie scelte</button>
                </div>
            </div>
        </div>
    </div>
    
    <!--contents for pages-->
    <div class="content" data-bs-spy="scroll" data-bs-target="#navLinks" data-bs-smooth-scroll="true" tabindex="0">
        {% block content %} {% endblock %}
    </div>
    
    <!--footer and credits-->
    <footer>
        <div class="footer-in">
            <img src="{{ url_for('static', filename='images/swallowspot_footer_icon.png') }}" alt="SwallowSpot">
            <div class="credits-out">
                <div class="foot-title">
                    <h2>SwallowSpot</h2>
                </div>
                <div class="credits-in">
                    <div class="column">
                        <div class="row foot-subtitle">Realizzato da</div>
                        <div class="row">Degetto Tommaso</div>
                        <div class="row">Maggiotto Giacomo</div>
                        <div class="row">Martini Davide</div>
                        <div class="row">La Rosa Leonardo</div>
                        <div class="row">Stefani Marco</div>
                        <div class="row">Tosin Filippo</div>
                    </div>
                    <div class="column">
                        <div class="row foot-subtitle">In collaborazione con</div>
                        <div class="row">Regione Veneto</div>
                        <div class="row">Comune di Bassano del Grappa</div>
                        <div class="row">Istituto ITIS E. Fermi</div>
                    </div>
                    <div class="column">
                        <div class="row foot-subtitle">Info Utili</div>
                        <div class="row">mail</div>
                        <div class="row">number</div>
                        <div class="row">boh altro</div>
                    </div>
                    <div class="column">
                        <div class="row foot-subtitle">Creato con</div>
                        <div class="row">Flask</div>
                        <div class="row">Bootstrap</div>
                        <div class="row">Font Awesome</div>
                        <div class="row">W3schools</div>
                        <div class="row">Chat GPT</div>
                    </div>
                </div>
            </div>
        </div>
        <!--social links-->
        <div class="social">
            <h2>Contattaci</h2>
            <div class="social-links">
                <button id="telegram"><i class="fa-brands fa-telegram"></i></button>
                <button id="facebook"><i class="fa-brands fa-facebook"></i></button>
                <button id="mail"><i class="fa-solid fa-envelope"></i></button>
                <button id="regioneveneto"><i class="fa-solid fa-earth-americas"></i></button>
            </div>
        </div>
        <div class="copyright"><i class="fa-regular fa-copyright"></i> Copyright 2024</div>
    </footer>
</body>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
    //disappearing navbar function
    /*var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (prevScrollpos > currentScrollPos) {
            document.getElementById("menu").style.top = "0";
        } else {
            document.getElementById("menu").style.top = "-100px";
        }
        prevScrollpos = currentScrollPos;
    }*/
    // Check if browser supports Notifications API
    navigator.serviceWorker.addEventListener('message', event => {
        if (event.data && event.data.action === 'showNotification') {
          // Request permission to show notifications
          Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
              // Show notification
              new Notification('Notification Title', {
                body: 'Notification Body'
              });
            }
          });
        }
      });

      
    //cookies functions
    function reject(){
        cookies1 = document.getElementById("cookies");
        cookies2 = document.getElementById("customizeCookies");
        cookies1.classList.add("disappear");
        setTimeout(() => { cookies1.remove(); cookies2.remove(); }, 1000);
    }

    //light/dark mode
    var body = document.querySelector("body");
    var cookiesLabel = document.getElementById("cookies");
    var cookiesModal = document.getElementById("customizeCookies");

    if(localStorage.getItem("mode") == "dark") {
        //dark mode
        body.style.backgroundColor = "#222222";
        body.style.color = "white";
        cookiesLabel.style.backgroundColor = "#222222";
        cookiesModal.setAttribute('data-bs-theme', "dark");
    }
    else {
        //light mode
        body.style.backgroundColor = "#EDFCFF";
        body.style.color = "#212529";
        cookiesLabel.style.backgroundColor = "#EDFCFF";
        cookiesModal.setAttribute('data-bs-theme', "light");
    }

    //show password for profile (it has to stay here)
    $(document).ready(function () {
        $('#showPasswordToggle1').on('click', function () {
            var passwordInput = $('#psw1');
            var type = passwordInput.attr('type') === 'password' ? 'text' : 'password';
            passwordInput.attr('type', type);
            $(this).find('i').toggleClass('fa-eye fa-eye-slash');
        });
    });

    $(document).ready(function () {
        $('#showPasswordToggle2').on('click', function () {
            var passwordInput = $('#psw2');
            var type = passwordInput.attr('type') === 'password' ? 'text' : 'password';
            passwordInput.attr('type', type);
            $(this).find('i').toggleClass('fa-eye fa-eye-slash');
        });
    });

    $(document).ready(function () {
        $('#showOldPasswordToggle').on('click', function () {
            var passwordInput = $('#pswOld');
            var type = passwordInput.attr('type') === 'password' ? 'text' : 'password';
            passwordInput.attr('type', type);
            $(this).find('i').toggleClass('fa-eye fa-eye-slash');
        });
    });

    //show psw requirements
    function showRequirements() {
        var bubble = document.getElementById("requirements");

        bubble.classList.remove("dismissed");
        bubble.classList.add("showing");
        bubble.style.display = "block";
        bubble.style.opacity = "1";
    }

    function dismissRequirements() {
        var bubble = document.getElementById("requirements");

        bubble.classList.remove("showing");
        bubble.classList.add("dismissed");
        bubble.style.display = "none";
        bubble.style.opacity = "0";
    }

    // Check if the browser supports notifications
if ('Notification' in window) {
    // Request permission for notifications
    Notification.requestPermission()
    .then(function(permission) 
    {
        // If permission is granted
        if (permission === 'granted') {
            // Add event listener to the button
            document.getElementById('telegram').addEventListener('click', function() {
                // Create a new notification
                var notification = new Notification('New Notification', {
                    body: 'This is a notification message.'
                });
            });
        }
    });
}
</script>
<!-- in caso di necessità-->
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</html>